
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Documentación de Optichat &#8212; Documentación de Optichat</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Recomendaciones y anotaciones legales" href="reco.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
  
    <p class="title logo__title">Documentación de Optichat</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Documentación de Optichat
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reco.html"><strong>Recomendaciones y anotaciones legales</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/docs.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Documentación de Optichat</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion"><strong>Introducción</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#react-app-y-micro-backend-optichat-redesign"><strong>React App y micro-backend (Optichat-Redesign)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-src"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">src/</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-jsx"><strong><code class="docutils literal notranslate"><span class="pre">main.jsx</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#app-jsx"><strong><code class="docutils literal notranslate"><span class="pre">App.jsx</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-assets"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">assets/</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-components-sidebar-jsx"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">components/Sidebar.jsx</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-pages"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">pages/</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-styles"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">styles/</span></code></strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-funcional-base-backend"><strong>Código Funcional Base (Backend)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><strong>Conclusión</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="documentacion-de-optichat">
<h1><strong>Documentación de Optichat</strong><a class="headerlink" href="#documentacion-de-optichat" title="Link to this heading">#</a></h1>
<p><strong>Versión:</strong> 1.0
<strong>Autor:</strong> Equipo de Tecnología de Optichat
<strong>Fecha:</strong> 25 de junio de 2025</p>
<hr class="docutils" />
<section id="introduccion">
<h2><strong>Introducción</strong><a class="headerlink" href="#introduccion" title="Link to this heading">#</a></h2>
<p>Optichat representa la evolución de las soluciones de mensajería empresarial, combinando una interfaz web avanzada con un motor de backend robusto para procesar grandes volúmenes de datos y orquestar envíos precisos a través de WhatsApp Business. Desde su concepción, nuestros objetivos centrales fueron garantizar la modularidad del sistema y la trazabilidad de cada transacción, así como facilitar la labor de los equipos de desarrollo, operaciones y auditoría.</p>
<p>La aplicación React, construida sobre Vite y React 18, integra de manera nativa un micro-servicio FastAPI que expone las rutas necesarias para autenticación, configuración y envío de mensajes. Esta aproximación “full-stack dentro de un mismo repositorio” permite a los desarrolladores iterar de forma ágil tanto en frontend como en backend, compartiendo la misma base de código y configuraciones de entorno. De este modo, se reducen los costos de contexto y se unifican los procesos de despliegue.</p>
<p>De manera paralela, el proyecto incluye un conjunto de scripts y notebooks Python dedicados al análisis y modelado de datos históricos de mensajería. Aunque estos artefactos no están conectados directamente con la SPA, sientan las bases para futuras funcionalidades de analítica avanzada, detección de anomalías y generación de reportes internos. La separación de esta lógica garantiza que los ciclos de desarrollo de producto y de data science puedan avanzar de manera independiente.</p>
<p>A lo largo de este documento, se detallan con un nivel de profundidad propio de equipos de tecnología de primer nivel cada uno de los módulos que componen Optichat. Se abordarán las decisiones arquitectónicas, los patrones de diseño aplicados y los flujos de datos críticos, así como las recomendaciones para extender y mantener el sistema en entornos productivos.</p>
</section>
<hr class="docutils" />
<section id="react-app-y-micro-backend-optichat-redesign">
<h2><strong>React App y micro-backend (Optichat-Redesign)</strong><a class="headerlink" href="#react-app-y-micro-backend-optichat-redesign" title="Link to this heading">#</a></h2>
<p>La carpeta <code class="docutils literal notranslate"><span class="pre">backend/</span></code> contiene el micro-servicio FastAPI que se levanta en paralelo con la SPA y está diseñado para atender exclusivamente las llamadas necesarias desde React, sin fungir como un servicio independiente. Esta estrategia reduce la latencia y facilita el desarrollo full-stack.</p>
<p>El archivo <code class="docutils literal notranslate"><span class="pre">database.py</span></code> centraliza la configuración de la capa de persistencia. Al importarse, carga de manera automática el archivo <code class="docutils literal notranslate"><span class="pre">.env</span></code> mediante <code class="docutils literal notranslate"><span class="pre">python-dotenv</span></code>, creando un <code class="docutils literal notranslate"><span class="pre">MongoClient</span></code> único que aprovecha el pool de conexiones nativo para optimizar la eficiencia en consultas concurrentes. A partir de este cliente, se exponen tres colecciones de alto nivel (<code class="docutils literal notranslate"><span class="pre">usuarios_collection</span></code>, <code class="docutils literal notranslate"><span class="pre">empresas_collection</span></code> y <code class="docutils literal notranslate"><span class="pre">configuracion_collection</span></code>), que encapsulan las operaciones CRUD y aseguran una única fuente de verdad para los datos en toda la aplicación.</p>
<p>En <code class="docutils literal notranslate"><span class="pre">models.py</span></code> se definen los esquemas Pydantic que validan y documentan las estructuras de datos que fluyen entre el cliente y el servidor. Estas definiciones no solo imponen restricciones de tipo y formato, sino que también generan la documentación OpenAPI automáticamente, permitiendo a los desarrolladores conocer de forma precisa los contratos de cada endpoint.</p>
<p>El archivo <code class="docutils literal notranslate"><span class="pre">meta_api.py</span></code> aísla el vínculo con servicios externos: su función principal construye los encabezados de autenticación necesarios, lanza peticiones HTTP al endpoint de plantillas, parsea las respuestas y aplica lógica de reintentos y manejo de errores. Al separar esta lógica, cualquier cambio en el proveedor de plantillas queda completamente desacoplado de la lógica de negocio interna.</p>
<p>El corazón del micro-servicio reside en <code class="docutils literal notranslate"><span class="pre">main.py</span></code>, donde se inicializa FastAPI con middleware de CORS y se definen los endpoints <code class="docutils literal notranslate"><span class="pre">/login</span></code>, <code class="docutils literal notranslate"><span class="pre">/plantillas-meta</span></code> y <code class="docutils literal notranslate"><span class="pre">/enviar-mensajes</span></code>. Cada ruta implementa validaciones tempranas de parámetros (como la verificación de <code class="docutils literal notranslate"><span class="pre">ObjectId</span></code>), transforma los documentos de Mongo a JSON mediante una función recursiva de serialización y orquesta las tareas de negocio: autenticación, recuperación de configuraciones y envíos atómicos de mensajes. La atención a los códigos HTTP y los registros de log contribuyen a ofrecer una experiencia de depuración efectiva.</p>
<p>Finalmente, <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> congela versiones específicas de las dependencias críticas (FastAPI, Uvicorn, Pymongo, Pandas, Requests, Validators), asegurando que los despliegues sean reproducibles y que las actualizaciones de librerías se realicen de forma controlada.</p>
<section id="carpeta-src">
<h3><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">src/</span></code></strong><a class="headerlink" href="#carpeta-src" title="Link to this heading">#</a></h3>
<p>El directorio <code class="docutils literal notranslate"><span class="pre">src/</span></code> contiene la Single-Page Application (SPA) de Optichat y asume la responsabilidad de toda la interacción del usuario con la plataforma. Está diseñada con React 18 y Vite para garantizar tiempos de arranque rápidos, recarga en caliente durante el desarrollo y un bundle optimizado en producción. La organización de este directorio obedece a criterios de modularidad, separación de preocupaciones y escalabilidad.</p>
<p>A continuación se presenta un resumen de la función y el cometido de cada agrupación dentro de <code class="docutils literal notranslate"><span class="pre">src/</span></code>, seguido de descripciones detalladas de los archivos principales.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Ruta / Archivo</p></th>
<th class="head"><p>Propósito clave</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">main.jsx</span></code></p></td>
<td><p>Punto de entrada de la aplicación React; monta el componente raíz y aplica providers globales.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">App.jsx</span></code></p></td>
<td><p>Define el layout base y el enrutamiento de la SPA con código diferido para optimización.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">assets/</span></code></p></td>
<td><p>Carpeta de recursos estáticos (imágenes, logos) gestionados por Vite para caching y hashing.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">components/Sidebar.jsx</span></code></p></td>
<td><p>Navegación lateral persistente; gestiona estado de colapso y selección de ruta activa.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pages/*</span></code></p></td>
<td><p>Conjunto de vistas de negocio; cada archivo corresponde a una pantalla específica.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">styles/</span></code></p></td>
<td><p>Estilos SCSS modulares; <code class="docutils literal notranslate"><span class="pre">global.scss</span></code> establece variables de tema y mixins de uso general.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="main-jsx">
<h3><strong><code class="docutils literal notranslate"><span class="pre">main.jsx</span></code></strong><a class="headerlink" href="#main-jsx" title="Link to this heading">#</a></h3>
<p>El archivo <code class="docutils literal notranslate"><span class="pre">main.jsx</span></code> actúa como la semilla de la aplicación. Dentro de él, React se vincula al elemento DOM especificado en <code class="docutils literal notranslate"><span class="pre">index.html</span></code> y se instancian los proveedores a nivel de aplicación, entre los que destacan el enrutador (<code class="docutils literal notranslate"><span class="pre">BrowserRouter</span></code>) y el contexto de autenticación. Gracias a esta capa de proveedores, todos los componentes anidados pueden acceder a la configuración global de rutas y al estado de sesión sin necesidad de prop drilling, lo que simplifica la estructura y mejora la mantenibilidad.</p>
</section>
<section id="app-jsx">
<h3><strong><code class="docutils literal notranslate"><span class="pre">App.jsx</span></code></strong><a class="headerlink" href="#app-jsx" title="Link to this heading">#</a></h3>
<p>En <code class="docutils literal notranslate"><span class="pre">App.jsx</span></code> se concentra la lógica de navegación y la disposición general de la interfaz. Este archivo importa un arreglo de objetos de ruta que define la correspondencia entre URL y componente, y registra cada uno con <code class="docutils literal notranslate"><span class="pre">&lt;Route&gt;</span></code> de React Router. Se incorpora <code class="docutils literal notranslate"><span class="pre">React.Suspense</span></code> junto a <code class="docutils literal notranslate"><span class="pre">React.lazy</span></code> para habilitar el code-splitting, de modo que cada vista se cargue únicamente cuando el usuario navega a ella, reduciendo el peso del bundle inicial. Asimismo, <code class="docutils literal notranslate"><span class="pre">App.jsx</span></code> incluye el componente <code class="docutils literal notranslate"><span class="pre">Sidebar</span></code> como parte del layout fijo, envolviendo el contenido principal en un contenedor que responde automáticamente a los cambios de tamaño de pantalla para asegurar una experiencia responsive.</p>
</section>
<section id="carpeta-assets">
<h3><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">assets/</span></code></strong><a class="headerlink" href="#carpeta-assets" title="Link to this heading">#</a></h3>
<p>Los recursos estáticos residen en <code class="docutils literal notranslate"><span class="pre">assets/</span></code>, donde se almacenan imágenes como <code class="docutils literal notranslate"><span class="pre">optichat-logo.png</span></code>, banners y fondos de pantalla. Vite procesa estos archivos durante el build, aplicando hashing a sus nombres para permitir un caching agresivo en el navegador y acelerar la entrega de contenidos. El uso de imágenes SVG y PNG optimizadas garantiza compatibilidad cross-browser y una carga eficiente en conexiones de baja latencia.</p>
</section>
<section id="carpeta-components-sidebar-jsx">
<h3><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">components/Sidebar.jsx</span></code></strong><a class="headerlink" href="#carpeta-components-sidebar-jsx" title="Link to this heading">#</a></h3>
<p>El componente <code class="docutils literal notranslate"><span class="pre">Sidebar.jsx</span></code> implementa la navegación lateral que acompaña a todas las vistas. Su lógica consiste en iterar sobre una lista de rutas definida en un módulo de configuración, renderizando un enlace por cada entrada y aplicando estilos condicionales según la ruta activa detectada con el hook <code class="docutils literal notranslate"><span class="pre">useLocation</span></code>. Además, maneja un estado booleano <code class="docutils literal notranslate"><span class="pre">collapsed</span></code> que controla su ancho y la visibilidad de las etiquetas, permitiendo un modo compacto para pantallas pequeñas o cuando el usuario desea maximizar el espacio de contenido.</p>
</section>
<section id="carpeta-pages">
<h3><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">pages/</span></code></strong><a class="headerlink" href="#carpeta-pages" title="Link to this heading">#</a></h3>
<p>La carpeta <code class="docutils literal notranslate"><span class="pre">pages/</span></code> agrupa las pantallas de negocio que componen el flujo de la aplicación:</p>
<ul class="simple">
<li><p><strong>Login.jsx</strong>: encapsula un formulario controlado donde el usuario ingresa sus credenciales. Emplea validaciones sincrónicas para garantizar que ambos campos estén completos y utiliza el endpoint <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/login</span></code> del micro-backend para autenticar, gestionando errores y redirecciones posteriores.</p></li>
<li><p><strong>Home.jsx</strong>: muestra un dashboard con indicadores clave de rendimiento (KPIs), gráficos implementados con <code class="docutils literal notranslate"><span class="pre">recharts</span></code> y una tabla de actividad reciente. Este componente orquesta múltiples llamadas concurrentes a la API, unifica estados de carga mediante hooks personalizados (<code class="docutils literal notranslate"><span class="pre">usePlantillas</span></code>) y ofrece un diseño adaptable a diferentes resoluciones.</p></li>
<li><p><strong>AdministrarPlantillas.jsx</strong> y <strong>ProgramarMensajeria.jsx</strong>: estas vistas comparten patrones de diseño de formularios y tablas. El primero permite CRUD completo de plantillas, combinando formularios y tablas interactivas; el segundo extiende esa lógica para permitir la subida de archivos Excel, validación de columnas y programación de envíos, invocando <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/enviar-mensajes</span></code>.</p></li>
<li><p><strong>CalendarioMensajeria.jsx</strong>: despliega un calendario basado en <code class="docutils literal notranslate"><span class="pre">fullcalendar</span></code>, adaptado a la estética corporativa. Ofrece vistas mensual, semanal y diaria, así como la capacidad de filtrar eventos según criterios de plantilla o estado.</p></li>
<li><p><strong>Configuracion.jsx</strong> y <strong>ComingSoon.jsx</strong>: la primera proporciona formularios de actualización de perfil y parámetros de empresa usando <code class="docutils literal notranslate"><span class="pre">react-hook-form</span></code>; la segunda muestra un placeholder para futuras funcionalidades, manteniendo el estilo visual del resto de la aplicación.</p></li>
</ul>
<p>Cada componente de página carga su propio archivo SCSS correspondiente desde <code class="docutils literal notranslate"><span class="pre">styles/</span></code>, manteniendo el principio de co-locación de código y estilos. Esto facilita la trazabilidad y reduce la posibilidad de colisiones en los estilos.</p>
</section>
<section id="carpeta-styles">
<h3><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">styles/</span></code></strong><a class="headerlink" href="#carpeta-styles" title="Link to this heading">#</a></h3>
<p>La carpeta <code class="docutils literal notranslate"><span class="pre">styles/</span></code> contiene un archivo <code class="docutils literal notranslate"><span class="pre">global.scss</span></code> que define variables de color corporativo (#1a4160), la fuente Poppins y mixins reutilizables para espacios y tipografías. Además, cada página o componente dispone de un archivo SCSS específico que aplica estilos locales usando la convención BEM. Durante el build, PostCSS y Autoprefixer aseguran compatibilidad con navegadores antiguos, mientras que la minificación de CSS reduce el tamaño final del bundle.</p>
</section>
</section>
<hr class="docutils" />
<section id="codigo-funcional-base-backend">
<h2><strong>Código Funcional Base (Backend)</strong><a class="headerlink" href="#codigo-funcional-base-backend" title="Link to this heading">#</a></h2>
<p>En este único notebook Python, se entrega un prototipo completo que aglutina las rutinas de construcción de plantillas, envío masivo de mensajes y recepción de notificaciones de WhatsApp Business, sirviendo como base para futuras integraciones. El flujo comienza con la configuración inicial, donde se importan los módulos <code class="docutils literal notranslate"><span class="pre">requests</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">datetime</span></code> y <code class="docutils literal notranslate"><span class="pre">pytz</span></code> para gestionar llamadas HTTP, procesamiento de datos tabulares y control de zonas horarias. A continuación, se definen constantes de entorno que ilustran los parámetros necesarios en producción: <code class="docutils literal notranslate"><span class="pre">ACCESS_TOKEN</span></code>, <code class="docutils literal notranslate"><span class="pre">WABA_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">PHONE_NUMBER_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">TEMPLATE_NAME</span></code> y la ruta al archivo Excel de prueba.</p>
<p>La función <code class="docutils literal notranslate"><span class="pre">get_template_details(template_name)</span></code> realiza una petición GET al endpoint de plantillas de Meta usando el token de acceso. Si la respuesta es satisfactoria, recorre la lista de plantillas disponibles hasta encontrar la que coincide con el nombre proporcionado, devolviendo su esquema completo; en caso contrario, registra un mensaje de error. Esta rutina aísla la obtención y validación de metadatos, permitiendo reutilizarla en diferentes contextos.</p>
<p>Para manejar plantillas con componentes multimedia, la función <code class="docutils literal notranslate"><span class="pre">prompt_for_component(component_type,</span> <span class="pre">format_type)</span></code> solicita interactivamente al usuario las URLs o coordenadas necesarias (imagen, video, documento o ubicación). Esta aproximación garantiza que todos los componentes dinámicos de tipo HEADER disponen de la información requerida antes de enviar cualquier mensaje.</p>
<p>La construcción del contenido de cada mensaje se realiza en <code class="docutils literal notranslate"><span class="pre">build_message(template_data,</span> <span class="pre">recipient,</span> <span class="pre">name,</span> <span class="pre">additional_params)</span></code>. Este método itera sobre los componentes definidos en la plantilla, omitiendo secciones FOOTER, y genera un listado de parámetros según su tipo: texto para BODY, objetos con enlaces o coordenadas para HEADER multimedia. El resultado es un objeto JSON listo para enviarse a la API de WhatsApp Business.</p>
<p>La función <code class="docutils literal notranslate"><span class="pre">get_additional_params(template_data)</span></code> recorre los mismos componentes para detectar aquellos que requieren información adicional y utiliza <code class="docutils literal notranslate"><span class="pre">prompt_for_component</span></code> para obtenerla, devolviendo un diccionario que alimenta la construcción del mensaje.</p>
<p>El envío masivo se orquesta mediante <code class="docutils literal notranslate"><span class="pre">send_bulk_messages(file_path,</span> <span class="pre">template_data,</span> <span class="pre">additional_params)</span></code>, que carga el Excel en un DataFrame de pandas y extrae listas de números de teléfono y nombres. Para cada par, invoca <code class="docutils literal notranslate"><span class="pre">build_message</span></code> y realiza un POST individual al endpoint, capturando y registrando en una lista los posibles errores sin interrumpir el ciclo de envío.</p>
<p>Para programar envíos en una fecha y hora específicas, <code class="docutils literal notranslate"><span class="pre">schedule_messages(file_path,</span> <span class="pre">template_data,</span> <span class="pre">schedule_time)</span></code> utiliza el módulo <code class="docutils literal notranslate"><span class="pre">schedule</span></code> en combinación con <code class="docutils literal notranslate"><span class="pre">pytz</span></code> para comparar instantes locales. Tras verificar que la hora solicitada sea futura, bloquea la ejecución en un bucle hasta el momento indicado y luego lanza el envío masivo, mostrando un registro detallado del proceso y de cualquier fallo.</p>
<p>Complementan estas funcionalidades las rutinas auxiliares: <code class="docutils literal notranslate"><span class="pre">get_schedule_time()</span></code> permite al usuario introducir la fecha y hora mediante un prompt validado con <code class="docutils literal notranslate"><span class="pre">datetime.strptime</span></code>, y <code class="docutils literal notranslate"><span class="pre">validate_media_url(url)</span></code> efectúa una petición HEAD para asegurar la accesibilidad de URLs de medios antes de ser incluidas.</p>
<p>Adicionalmente, el notebook incluye secciones de prueba que muestran la creación y corrección de plantillas mediante peticiones POST a la Graph API de Meta, con distintos payloads adaptados a escenarios de marketing o utilidad. Estas células de ejemplo documentan cómo estructurar componentes de tipo HEADER, BODY, FOOTER y BUTTONS, y sirven como referencia inmediata para generar nuevos templates.</p>
<p>Al final, se define un servidor Flask minimalista con un endpoint <code class="docutils literal notranslate"><span class="pre">/webhook</span></code> que cumple la verificación inicial de Meta (respondiendo al desafío de suscripción) y procesa mensajería entrante. Este servidor ilustra el patrón de webhook para recibir notificaciones de eventos y permite extender la lógica de respuesta automática o integración con sistemas de análisis.</p>
<p>Este prototipo debe trasladarse al entorno de producción extrayendo las constantes a un sistema de configuración seguro, separando el código en módulos Python y exponiendo las funciones de envío y webhook como endpoints FastAPI o tareas programadas. De este modo, se garantizará la coherencia con la SPA de React y la robustez necesaria para un servicio empresarial.</p>
</section>
<hr class="docutils" />
<section id="conclusion">
<h2><strong>Conclusión</strong><a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>El prototipo entregado en este repositorio reúne los componentes esenciales de Optichat: una aplicación React con su micro-servicio FastAPI para gestionar autenticación, plantillas y envíos de mensajería, y un módulo de código base en Python que ilustra las rutinas de construcción de plantillas, envíos masivos y recepción de notificaciones mediante webhooks. Cada pieza ha sido diseñada para facilitar el desarrollo posterior, con flujos de datos claros, contratos de servicio definidos y una estructura modular que permite evolucionar cada capa de forma independiente. El siguiente equipo dispondrá de una visión completa del sistema y de los fundamentos técnicos necesarios para completar, corregir y optimizar el producto.</p>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="right-next"
       href="reco.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Recomendaciones y anotaciones legales</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion"><strong>Introducción</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#react-app-y-micro-backend-optichat-redesign"><strong>React App y micro-backend (Optichat-Redesign)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-src"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">src/</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-jsx"><strong><code class="docutils literal notranslate"><span class="pre">main.jsx</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#app-jsx"><strong><code class="docutils literal notranslate"><span class="pre">App.jsx</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-assets"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">assets/</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-components-sidebar-jsx"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">components/Sidebar.jsx</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-pages"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">pages/</span></code></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carpeta-styles"><strong>Carpeta <code class="docutils literal notranslate"><span class="pre">styles/</span></code></strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-funcional-base-backend"><strong>Código Funcional Base (Backend)</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><strong>Conclusión</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Equipo de Tecnología de Optichat
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>